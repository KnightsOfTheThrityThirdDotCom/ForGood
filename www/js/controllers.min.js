var serviceUrl="http://for-good.be/system/en/service/",sha=null;if(window.localStorage.user){var user=JSON.parse(window.localStorage.user);sha="/sha="+user.sha}angular.module("forgood.controllers",[]).controller("MainCtrl",function(o,e,t,a){var n=document.getElementsByClassName("pop-up"),r=n[0].getElementsByClassName("title"),c=n[0].getElementsByClassName("text");o.openPopup=function(o){console.log("test");var e=o.target.dataset.title,t=o.target.dataset.text;r[0].innerHTML=e,c[0].innerHTML=t,n[0].classList.remove("hidden")},o.closePopup=function(){n[0].classList.add("hidden")}}).controller("LogoutCtrl",function(o,e,t,a){a.nextViewOptions({disableBack:!0}),window.localStorage.clear(),t.go("login")}).controller("LoginCtrl",function(o,e,t,a,n){if(window.localStorage.user)var r=JSON.parse(window.localStorage.user);window.localStorage.user&&r.nulmeting?(console.log(r),t.go("progress"),a.nextViewOptions({disableBack:!0})):window.localStorage.user&&0===r.nulmeting&&(t.go("account-mobility"),a.nextViewOptions({disableBack:!0})),o.formData,o.processForm=function(){n.show({template:"Aanmelden..."}),e({method:"POST",crossDomain:!0,data:$.param(o.formData),url:serviceUrl+"login",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(o){if(a.nextViewOptions({disableBack:!0}),1===o.success){n.hide(),sha="/sha="+o.user.sha;var e=JSON.stringify(o.user);window.localStorage.user=e,t.go(1===o.user.nulmeting?"progress":"account-mobility")}else n.hide(),alert("Gelieve in te loggen met de juiste gegevens.")})}}).controller("CreateAccountCtrl",function(o,e,t,a){o.formData,o.processForm=function(){e({method:"POST",crossDomain:!0,data:$.param(o.formData),url:serviceUrl+"createProfile",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(o){if(a.nextViewOptions({disableBack:!0}),1===o.success){sha="/sha="+o.user.sha;var e=JSON.stringify(o.user);console.log(o.user.sha),window.localStorage.user=e,t.go("account-mobility")}else alert("Gelieve in te loggen met de juiste gegevens.")})}}).controller("ForgotPasswordCtrl",function(o,e,t,a){o.formData,o.processForm=function(){e({method:"POST",crossDomain:!0,data:$.param(o.formData),url:serviceUrl+"forgotPassword",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(o){a.nextViewOptions({disableBack:!0}),1===o.success?(console.log(o),t.go("login")):(console.log(o),alert("Van dit e-mail adres bestaan geen gegevens."))})}}).controller("MobilityCtrl",function(o,e,t){o.formData={},o.formData.unitType="1",o.processForm=function(){console.log(o.formData),e({method:"POST",crossDomain:!0,data:$.param(o.formData),url:serviceUrl+"updateMobilityProfile"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(o){t.go("account-energy")})}}).controller("EnergyCtrl",function(o,e,t){o.formData={electricityType:"2",yearlyConsumptionHeatingUnit:"2"},o.processForm=function(){console.log(o.formData),e({method:"POST",crossDomain:!0,data:$.param(o.formData),url:serviceUrl+"updateEnergyProfile"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(o){console.log(o),t.go("account-monitor")})}}).controller("MonitorCtrl",function(o,e,t,a){o.formData={},o.processForm=function(){console.log(o.formData),e({method:"POST",crossDomain:!0,data:$.param(o.formData),url:serviceUrl+"updateService"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(o){console.log(o),a.nextViewOptions({disableBack:!0}),t.go("progress")})}}).controller("ProgressCtrl",function(o,e,t,a){var n;o.init=function(){e({method:"POST",crossDomain:!0,data:o.formData,url:serviceUrl+"stats"+sha}).success(function(e){o.dataTotal=e,console.log(o.dataTotal);var t={chartTotal:[{value:e.chart.CIRCLE_MOBILITEIT_100,color:"#46acf1"},{value:e.chart.CIRCLE_ENERGY_100,color:"#eecc30"},{value:e.chart.CIRCLE_FOOD_100,color:"#f7395e"}],chartMobility:[{value:30,color:"#235679"},{value:50,color:"#388ac1"},{value:20,color:"#46acf1"}],chartEnergy:[{value:30,color:"#776618"},{value:70,color:"#bea326"}],chartConsumption:[{value:10,color:"#7c1d2f"},{value:30,color:"#c62e4b"},{value:20,color:"#f7395e"},{value:20,color:"#fb9cae"},{value:20,color:"#46acf1"}]},a=document.getElementById("chart-total").getContext("2d"),n=document.getElementById("chart-mobility").getContext("2d"),r=document.getElementById("chart-energy").getContext("2d"),c=document.getElementById("chart-consumption").getContext("2d"),s={animation:!1,segmentStrokeWidth:1,percentageInnerCutout:65,segmentStrokeColor:"#f3efe7"};new Chart(a).Doughnut(t.chartTotal,s),new Chart(n).Doughnut(t.chartMobility,s),new Chart(r).Doughnut(t.chartEnergy,s),new Chart(c).Doughnut(t.chartConsumption,s),o.dataTotal.chart.TOTAL_PLANET=o.dataTotal.chart.TOTAL_PLANET.toFixed(1)})},o.init();var r=document.getElementById("swipe-position").getElementsByTagName("span"),c=document.getElementById("graphs").getElementsByClassName("cats");window.mySwipe=Swipe(document.getElementById("swipe"),{continuous:!1,callback:function(o){console.log(c);for(var e=r.length;e--;)r[e].className="off",c[e].classList.remove("on");r[o].className="on",c[o].classList.add("on")}}),o.scan=function(){cordova.plugins.barcodeScanner.scan(function(o){console.log(o);var n={ean:o.text};e({method:"POST",crossDomain:!0,data:$.param(n),url:serviceUrl+"getProduct"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(o){a.submit(o),t.go("product")})},function(o){alert("Scanning failed: "+o)})}}).controller("UpdateCtrl",function(o,e,t,a){console.log("test"),o.init=function(){e({method:"POST",crossDomain:!0,data:o.formData,url:serviceUrl+"getProfile"+sha}).success(function(e){o.currentValue=e.user,console.log(o)})},o.init(),o.formData={},o.processForm=function(){console.log(o.formData),e({method:"POST",crossDomain:!0,data:o.formData,url:serviceUrl+"updateService"+sha}).success(function(o){console.log(o),a.nextViewOptions({disableBack:!0}),t.go("progress")})}}).controller("ProductCtrl",function(o,e,t,a,n){o.init=function(){o.product=n.get(),console.log(o.product)},o.init()}).controller("AccCtrl",function(o){o.accordion=$(".accordion"),o.accordion.$accordionWrapper=o.accordion.find(".acc-wrapper"),o.accordion.$accordionWrapper.each(function(){var e=$(this);$(this)[0].isActive=!1,$accordionTitle=$(this).find(".acc-title"),$accordionTitle.on("click",function(){var t=$(this);o.openAccordion(t,e)})}),o.openAccordion=function(e,t){var a=t[0].isActive;o.accordion.$accordionWrapper.each(function(){$(this).removeClass("active"),$(this)[0].isActive=!1}),a?(t.removeClass("active"),t[0].isActive=!1):(t.addClass("active"),t[0].isActive=!0)}});