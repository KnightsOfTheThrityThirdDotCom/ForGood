var serviceUrl="http://for-good.be/system/en/service/",sha=null;if(window.localStorage.user){var user=JSON.parse(window.localStorage.user);sha="/sha="+user.sha}angular.module("forgood.controllers",[]).controller("MainCtrl",function(e,o,t,a){var n=document.getElementsByClassName("pop-up"),r=n[0].getElementsByClassName("title"),c=n[0].getElementsByClassName("text");e.openPopup=function(e){console.log("test");var o=e.target.dataset.title,t=e.target.dataset.text;r[0].innerHTML=o,c[0].innerHTML=t,n[0].classList.remove("hidden")},e.closePopup=function(){n[0].classList.add("hidden")}}).controller("LogoutCtrl",function(e,o,t,a){a.nextViewOptions({disableBack:!0}),window.localStorage.clear(),t.go("login")}).controller("LoginCtrl",function(e,o,t,a,n){if(window.localStorage.user)var r=JSON.parse(window.localStorage.user);window.localStorage.user&&r.nulmeting?(console.log(r),t.go("progress"),a.nextViewOptions({disableBack:!0})):window.localStorage.user&&0===r.nulmeting&&(t.go("account-mobility"),a.nextViewOptions({disableBack:!0})),e.formData,e.processForm=function(){n.show({template:"Aanmelden..."}),o({method:"POST",crossDomain:!0,data:$.param(e.formData),url:serviceUrl+"login",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(e){if(a.nextViewOptions({disableBack:!0}),1===e.success){n.hide(),sha="/sha="+e.user.sha;var o=JSON.stringify(e.user);window.localStorage.user=o,t.go(1===e.user.nulmeting?"progress":"account-mobility")}else n.hide(),alert("Gelieve in te loggen met de juiste gegevens.")})}}).controller("CreateAccountCtrl",function(e,o,t,a){e.formData,e.processForm=function(){o({method:"POST",crossDomain:!0,data:$.param(e.formData),url:serviceUrl+"createProfile",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(e){if(a.nextViewOptions({disableBack:!0}),1===e.success){sha="/sha="+e.user.sha;var o=JSON.stringify(e.user);console.log(e.user.sha),window.localStorage.user=o,t.go("account-mobility")}else alert("Gelieve in te loggen met de juiste gegevens.")})}}).controller("ForgotPasswordCtrl",function(e,o,t,a){e.formData,e.processForm=function(){o({method:"POST",crossDomain:!0,data:$.param(e.formData),url:serviceUrl+"forgotPassword",headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(e){a.nextViewOptions({disableBack:!0}),1===e.success?(console.log(e),t.go("login")):(console.log(e),alert("Van dit e-mail adres bestaan geen gegevens."))})}}).controller("MobilityCtrl",function(e,o,t){e.formData={},e.formData.unitType="1",e.processForm=function(){console.log(e.formData),o({method:"POST",crossDomain:!0,data:$.param(e.formData),url:serviceUrl+"updateMobilityProfile"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(e){t.go("account-energy")})}}).controller("EnergyCtrl",function(e,o,t){e.formData={electricityType:"2",yearlyConsumptionHeatingUnit:"2"},e.processForm=function(){console.log(e.formData),o({method:"POST",crossDomain:!0,data:$.param(e.formData),url:serviceUrl+"updateEnergyProfile"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(e){console.log(e),t.go("account-monitor")})}}).controller("MonitorCtrl",function(e,o,t,a){e.formData={},e.processForm=function(){console.log(e.formData),o({method:"POST",crossDomain:!0,data:$.param(e.formData),url:serviceUrl+"updateService"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(e){console.log(e),a.nextViewOptions({disableBack:!0}),t.go("progress")})}}).controller("ProgressCtrl",function(e,o,t,a){var n;e.init=function(){o({method:"POST",crossDomain:!0,data:e.formData,url:serviceUrl+"stats"+sha}).success(function(o){e.dataTotal=o,console.log(e.dataTotal);var t={chartTotal:[{value:o.chart.CIRCLE_MOBILITEIT_100,color:"#46acf1"},{value:o.chart.CIRCLE_ENERGY_100,color:"#eecc30"},{value:o.chart.CIRCLE_FOOD_100,color:"#f7395e"}],chartMobility:[{value:30,color:"#235679"},{value:50,color:"#388ac1"},{value:20,color:"#46acf1"}],chartEnergy:[{value:30,color:"#776618"},{value:70,color:"#bea326"}],chartConsumption:[{value:10,color:"#7c1d2f"},{value:30,color:"#c62e4b"},{value:20,color:"#f7395e"},{value:20,color:"#fb9cae"},{value:20,color:"#46acf1"}]},a=document.getElementById("chart-total").getContext("2d"),n=document.getElementById("chart-mobility").getContext("2d"),r=document.getElementById("chart-energy").getContext("2d"),c=document.getElementById("chart-consumption").getContext("2d"),s={animation:!1,segmentStrokeWidth:1,percentageInnerCutout:65,segmentStrokeColor:"#f3efe7"};new Chart(a).Doughnut(t.chartTotal,s),new Chart(n).Doughnut(t.chartMobility,s),new Chart(r).Doughnut(t.chartEnergy,s),new Chart(c).Doughnut(t.chartConsumption,s),e.dataTotal.chart.TOTAL_PLANET=e.dataTotal.chart.TOTAL_PLANET.toFixed(1)})},e.init();var r=document.getElementById("swipe-position").getElementsByTagName("span"),c=document.getElementById("graphs").getElementsByClassName("cats");window.mySwipe=Swipe(document.getElementById("swipe"),{continuous:!1,callback:function(e){console.log(c);for(var o=r.length;o--;)r[o].className="off",c[o].classList.remove("on");r[e].className="on",c[e].classList.add("on")}}),e.scan=function(){cordova.plugins.barcodeScanner.scan(function(e){console.log(e);var n={ean:e.text};o({method:"POST",crossDomain:!0,data:$.param(n),url:serviceUrl+"getProduct"+sha,headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"}}).success(function(e){a.submit(e),t.go("product")})},function(e){alert("Scanning failed: "+e)})}}).controller("UpdateCtrl",function(e,o,t,a){console.log("test"),e.init=function(){o({method:"POST",crossDomain:!0,data:e.formData,url:serviceUrl+"getProfile"+sha}).success(function(o){e.currentValue=o.user,console.log(e)})},e.init()}).controller("ProductCtrl",function(e,o,t,a,n){e.init=function(){e.product=n.get(),console.log(e.product)},e.init()});